<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Posts - cjsommer.com</title><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"cjsommer.com","url":"https:\/\/www.cjsommer.com\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/www.cjsommer.com\/"}</script><meta property="og:title" content="Posts"><meta property="og:image" content="https://www.cjsommer.com/img/cjsommer-avatar-2.jpg"><meta property="og:url" content="https://www.cjsommer.com/post/"><meta property="og:type" content="website"><meta property="og:site_name" content="cjsommer.com"><meta name=twitter:title content="Posts"><meta name=twitter:image content="https://www.cjsommer.com/img/cjsommer-avatar-2.jpg"><meta name=twitter:card content="summary_large_image"><link href=https://www.cjsommer.com/img/favicon.ico rel=icon type=image/x-icon><meta name=generator content="Hugo 0.150.0"><link rel=alternate href=https://www.cjsommer.com/index.xml type=application/rss+xml title=cjsommer.com><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v6.6.0/css/all.css integrity=sha384-h/hnnw1Bi4nbpD6kE7nYfCXzovi622sY5WBxww8ARKwpdLj5kUWjRuyiXaD1U2JT crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><link rel=stylesheet href=https://www.cjsommer.com/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://www.cjsommer.com/css/highlight.min.css><link rel=stylesheet href=https://www.cjsommer.com/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=https://www.cjsommer.com/>cjsommer.com</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Home href=/>Home</a></li><li><a title="SQL Server" href=/tags/sql-server/>SQL Server</a></li><li><a title=PowerShell href=/tags/powershell/>PowerShell</a></li><li><a title=Professional href=/tags/professional/>Professional</a></li><li><a title=About href=/page/about/>About</a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title=cjsommer.com href=https://www.cjsommer.com/><img class=avatar-img src=https://www.cjsommer.com/img/cjsommer-avatar-2.jpg alt=cjsommer.com></a></div></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>Posts</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on September 23, 2025
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;0&nbsp;words</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=posts-list><article class=post-preview><a href=https://www.cjsommer.com/post/2015-04-14-modify-sqljobs-powershell-smo/><h2 class=post-title>Modify SQL Agent Jobs using PowerShell and SMO</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on April 14, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1087&nbsp;words</span></p><div class=post-entry><p>So here we are, week 2 of the #SQLNewBlogger Challenge. This is a follow on to last weeks post Monitoring SQL Agent Jobs when you work for Mr Krabs where I showed you how to go about monitoring SQL Server agent jobs using PowerShell and SMO. This can be very helpful if you are on a limited budget and can&rsquo;t afford any fancy monitoring tools. </p><a href=https://www.cjsommer.com/post/2015-04-14-modify-sqljobs-powershell-smo/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/powershell/>Powershell</a>&nbsp;
<a href=https://www.cjsommer.com/tags/sql-server/>SQL Server</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-04-01-mrkrabs-sqlagent-job-monitoring/><h2 class=post-title>Monitoring SQL Agent Jobs when you work for Mr Krabs</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on April 1, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1009&nbsp;words</span></p><div class=post-entry><p>For those of you who don&rsquo;t know who Mr. Krabs is, he is a character in the TV show Sponge Bob Square Pants. Mr. Krabs owns the Krusty Krab restaurant and is a very frugal business owner. Every decision he makes is driven completely on how it will impact his bottom line.</p><p>Thinking about Mr. Krabs reminds me of one of my first SQL Server DBA jobs. I was starting just as the old DBA was leaving and there wasn&rsquo;t a lot of time for turnover. I was the only DBA on staff, my servers were old, the CPU&rsquo;s slow, the disk drives were small, and none of it was being monitored! Yikes! Monitoring was one thing I knew I had to address right away, but I didn&rsquo;t have a budget to work with! The business just wasn&rsquo;t willing to spend the money on a fancy monitoring application. They were my Mr. Krabs!</p><a href=https://www.cjsommer.com/post/2015-04-01-mrkrabs-sqlagent-job-monitoring/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/powershell/>Powershell</a>&nbsp;
<a href=https://www.cjsommer.com/tags/sql-server/>SQL Server</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-03-30-intro-to-sql-server-automation-with-powershell/><h2 class=post-title>Intro to SQL Server Automation with PowerShell</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 30, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;203&nbsp;words</span></p><div class=post-entry><p>March 26th, 2015, a date which will live in infamy!</p><p>Well, at least for me it will. March 26th, 2015 marks the date I gave my first presentation at my local SQL PASS user group meeting. Here is the picture as proof!</p><p></p><p>I was very excited to be able to share some of my knowledge with everyone who showed up. I hope to be able to do it again some time.</p><a href=https://www.cjsommer.com/post/2015-03-30-intro-to-sql-server-automation-with-powershell/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/powershell/>Powershell</a>&nbsp;
<a href=https://www.cjsommer.com/tags/presentations/>Presentations</a>&nbsp;
<a href=https://www.cjsommer.com/tags/sql-server/>SQL Server</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-03-24-posh-20-array-gotcha/><h2 class=post-title>Gotcha! PowerShell Array Initialization, Difference between PowerShell 2.0 and 4.0</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 24, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;355&nbsp;words</span></p><div class=post-entry><p>I like to initialize my arrays by strongly typing my variable as an array, and setting it to null. PowerShell doesn&rsquo;t require strongly typed variables, so why would I want to do this?</p><p>The primary reason is because it allows me to deal with an expected object type later in the code. For arrays it gives me access to a count property, which I don&rsquo;t get with strings, int&rsquo;s or other non-collection type objects.</p><a href=https://www.cjsommer.com/post/2015-03-24-posh-20-array-gotcha/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/powershell/>Powershell</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-03-24-new-timespan/><h2 class=post-title>Using New-TimeSpan to convert friendly time</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 24, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;129&nbsp;words</span></p><div class=post-entry><p>The question was this:</p><p></p><p>This is just a quick/fast snippet in response to that question, but I can think of a ton of enhancements that could made. Hopefully it will be useful as a starting point for someone to customize for their own use.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> Convert-FriendlyTime
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>param</span> (
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>string</span>]$FriendlyTime 
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $Converted = $FriendlyTime.Split(<span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> ($Converted[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;days&#34;</span>    { $parms = @{<span style=color:#e6db74>&#34;days&#34;</span>=$Converted[<span style=color:#ae81ff>0</span>]}; <span style=color:#66d9ef>break</span> ;}
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;hours&#34;</span>   { $parms = @{<span style=color:#e6db74>&#34;hours&#34;</span>=$Converted[<span style=color:#ae81ff>0</span>]}; <span style=color:#66d9ef>break</span> ;}
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;minutes&#34;</span> { $parms = @{<span style=color:#e6db74>&#34;minutes&#34;</span>=$Converted[<span style=color:#ae81ff>0</span>]}; <span style=color:#66d9ef>break</span> ;}
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;seconds&#34;</span> { $parms = @{<span style=color:#e6db74>&#34;seconds&#34;</span>=$Converted[<span style=color:#ae81ff>0</span>]}; <span style=color:#66d9ef>break</span> ;}
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;default&#34;</span> { $parms = $null; <span style=color:#66d9ef>break</span> ;}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($parms) {
</span></span><span style=display:flex><span>        New-TimeSpan @parms
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Throw</span> <span style=color:#e6db74>&#34;Invalid unit of time &#39;</span>$FriendlyTime<span style=color:#e6db74>&#39;. Please use days, hours, minutes or seconds.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Convert-FriendlyTime -FriendlyTime <span style=color:#e6db74>&#34;2 days&#34;</span>
</span></span><span style=display:flex><span>Convert-FriendlyTime -FriendlyTime <span style=color:#e6db74>&#34;68 hours&#34;</span>
</span></span><span style=display:flex><span>Convert-FriendlyTime -FriendlyTime <span style=color:#e6db74>&#34;68 InvalidUnits&#34;</span>
</span></span></code></pre></div></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/powershell/>Powershell</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-03-24-sql-agent-smo/><h2 class=post-title>Configure SQL Server Agent using SMO</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 24, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;104&nbsp;words</span></p><div class=post-entry><p>Saw this on twitter and thought I would throw it up on the blog. Easier than responding on twitter.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[<span style=color:#66d9ef>System.Reflection.Assembly</span>]::LoadWithPartialName(<span style=color:#e6db74>&#34;Microsoft.SqlServer.Smo&#34;</span>) | Out-Null;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$SQLServerInstance = <span style=color:#e6db74>&#34;MSSQLSERVER&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$srv = New-Object <span style=color:#e6db74>&#34;Microsoft.SqlServer.Management.Smo.Server&#34;</span> $SQLServerInstance
</span></span><span style=display:flex><span>$srv.JobServer.MaximumHistoryRows = <span style=color:#ae81ff>1002</span>
</span></span><span style=display:flex><span>$srv.JobServer.Alter()
</span></span></code></pre></div><p>You can manipulate most if not all SQL Server configurations through SMO. This simple post has inspired me a bit. I think it would be useful to show how I came to find the information I needed to modify this setting. The cool thing about PowerShell is that it&rsquo;s in there. All the tools you need already exist. Look back for an expansion of this post in the near future.</p></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/powershell/>Powershell</a>&nbsp;
<a href=https://www.cjsommer.com/tags/sql-server/>SQL Server</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-03-24-get-diskspace/><h2 class=post-title>Get-DiskSpace</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 24, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;261&nbsp;words</span></p><div class=post-entry><p>My cheap and dirty PowerShell script for dumping the disk space usage for a Windows machine. It was originally some snippets I found on the Internet, which I threw into a script and made it my own.</p><p>It uses a simple WMI call to return a set of objects for you to use as you see fit. Most of the time I just pipe it to Format-Table to see the output, but it could be used for other things. Throw in a pipe to Where-Object and you could use it to monitor low disk space. Feel free to bind, spindle or mutilate as you see fit.</p><a href=https://www.cjsommer.com/post/2015-03-24-get-diskspace/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/powershell/>Powershell</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-03-24-who-is-cjsommer/><h2 class=post-title>Who is cjsommer?</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 24, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;155&nbsp;words</span></p><div class=post-entry><p>I&rsquo;ve been a problem solver as far back as I can remember, always looking for a new challenge. I love staying current in technology, pushing the software to its limits, as well as finding its boundaries. For me there is satisfaction in knowing the answer to something because you have tried it out yourself. So a bit about me&mldr;</p><p>I&rsquo;ve worked with Unix, Windows, Informix, Oracle, SQL Server. I&rsquo;ve worked in small shops. I&rsquo;ve worked in large shops. I&rsquo;ve made lots of coffee. I&rsquo;ve drank lots of coffee. I&rsquo;ve had good on call weeks, and I&rsquo;ve had bad on call weeks. Okay, you probably get it; I have a diverse background. Do I know everything? Absolutely not! What I do know is that I still have that hunger for knowledge.</p><a href=https://www.cjsommer.com/post/2015-03-24-who-is-cjsommer/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/about-me/>About Me</a>&nbsp;</div></article><article class=post-preview><a href=https://www.cjsommer.com/post/2015-03-24-my-specialty/><h2 class=post-title>My Specialty</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 24, 2015
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;555&nbsp;words</span></p><div class=post-entry><p>So I was reading the following blog post by Brent Ozar and I think it finally hit me right between the eyes.</p><p>I think from a DBA perspective I would have to consider myself in the DevOPS realm, but more generally, I am an automation specialist. It&rsquo;s what I truly love to do and where I shine. Whether it&rsquo;s a simple information gathering exercise, or deploying database code, I enjoy automating it. Automation brings simplicity, scalability, consistency and reliability to a potentially complex process.</p><a href=https://www.cjsommer.com/post/2015-03-24-my-specialty/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://www.cjsommer.com/tags/about-me/>About Me</a>&nbsp;</div></article></div><ul class="pager main-pager"><li class=previous><a href=https://www.cjsommer.com/post/page/5/>&larr; Newer Posts</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=/post/index.xml title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">&nbsp;&bull;&nbsp;&copy;
2025
&nbsp;&bull;&nbsp;
<a href=https://www.cjsommer.com/>cjsommer.com</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.150.0</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script src=https://code.jquery.com/jquery-3.7.0.slim.min.js integrity=sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script><script src=https://www.cjsommer.com/js/main.js></script><script src=https://www.cjsommer.com/js/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script>$(document).ready(function(){$("pre.chroma").css("padding","0")})</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://www.cjsommer.com/js/load-photoswipe.js></script></body></html>