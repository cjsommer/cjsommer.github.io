<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>T-SQL Tuesday 94 - Do you wanna get PoSh? - cjsommer.com</title>
<meta name=description content="This month’s topic: Let’s get all Posh – What are you going to automate today? T-SQL Tuesday is a monthly blog party for the SQL Server community (or Microsoft Data Platform community. Although it’s called T-SQL Tuesday, it’s not limited to SQL Server database engine only). It is the brainchild of Adam Machanic (blog | twitter).
This month&rsquo;s T-SQL Tuesday is being hosted by Rob Sewell (blog | twitter). From his blog post:"><meta name=author content="Chris Sommer"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"cjsommer.com","url":"https:\/\/www.cjsommer.com"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/www.cjsommer.com"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/www.cjsommer.com","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/www.cjsommer.com\/post\/2017-09-11-tsql2sday-94-do-you-wanna-get-posh\/","name":"T SQL tuesday 94 do you wanna get po sh?"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"cjsommer@gmail.com"},"headline":"T-SQL Tuesday 94 - Do you wanna get PoSh?","description":"This month’s topic: Let’s get all Posh – What are you going to automate today? T-SQL Tuesday is a monthly blog party for the SQL Server community (or Microsoft Data Platform community. Although it’s called T-SQL Tuesday, it’s not limited to SQL Server database engine only). It is the brainchild of Adam Machanic (blog | twitter).\nThis month\u0026rsquo;s T-SQL Tuesday is being hosted by Rob Sewell (blog | twitter). From his blog post:","inLanguage":"en","wordCount":960,"datePublished":"2017-09-11T00:00:00","dateModified":"2017-09-11T00:00:00","image":"https:\/\/www.cjsommer.com\/img\/cjsommer-avatar-2.jpg","keywords":["SQL Server"],"mainEntityOfPage":"https:\/\/www.cjsommer.com\/post\/2017-09-11-tsql2sday-94-do-you-wanna-get-posh\/","publisher":{"@type":"Organization","name":"https:\/\/www.cjsommer.com","logo":{"@type":"ImageObject","url":"https:\/\/www.cjsommer.com\/img\/cjsommer-avatar-2.jpg","height":60,"width":60}}}</script><meta property="og:title" content="T-SQL Tuesday 94 - Do you wanna get PoSh?"><meta property="og:description" content="This month’s topic: Let’s get all Posh – What are you going to automate today? T-SQL Tuesday is a monthly blog party for the SQL Server community (or Microsoft Data Platform community. Although it’s called T-SQL Tuesday, it’s not limited to SQL Server database engine only). It is the brainchild of Adam Machanic (blog | twitter).
This month&rsquo;s T-SQL Tuesday is being hosted by Rob Sewell (blog | twitter). From his blog post:"><meta property="og:image" content="https://www.cjsommer.com/img/cjsommer-avatar-2.jpg"><meta property="og:url" content="https://www.cjsommer.com/post/2017-09-11-tsql2sday-94-do-you-wanna-get-posh/"><meta property="og:type" content="website"><meta property="og:site_name" content="cjsommer.com"><meta name=twitter:title content="T-SQL Tuesday 94 - Do you wanna get PoSh?"><meta name=twitter:description content="This month’s topic: Let’s get all Posh – What are you going to automate today? T-SQL Tuesday is a monthly blog party for the SQL Server community (or Microsoft Data Platform community. Although it’s …"><meta name=twitter:image content="https://www.cjsommer.com/img/cjsommer-avatar-2.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@sommerc70"><meta name=twitter:creator content="@sommerc70"><link href=https://www.cjsommer.com/img/favicon.ico rel=icon type=image/x-icon><meta name=generator content="Hugo 0.120.4"><link rel=alternate href=https://www.cjsommer.com/index.xml type=application/rss+xml title=cjsommer.com><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><link rel=stylesheet href=https://www.cjsommer.com/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://www.cjsommer.com/css/highlight.min.css><link rel=stylesheet href=https://www.cjsommer.com/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=https://www.cjsommer.com>cjsommer.com</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Home href=/>Home</a></li><li><a title="SQL Server" href=/tags/sql-server/>SQL Server</a></li><li><a title=PowerShell href=/tags/powershell/>PowerShell</a></li><li><a title=Professional href=/tags/professional/>Professional</a></li><li><a title=About href=/page/about/>About</a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title=cjsommer.com href=https://www.cjsommer.com><img class=avatar-img src=https://www.cjsommer.com/img/cjsommer-avatar-2.jpg alt=cjsommer.com></a></div></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>T-SQL Tuesday 94 - Do you wanna get PoSh?</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on September 11, 2017
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;960&nbsp;words</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><h1 id=this-months-topic-lets-get-all-posh--what-are-you-going-to-automate-today>This month’s topic: Let’s get all Posh – What are you going to automate today?</h1><p><img src=/img/TSQLTuesday.jpg alt="T-SQL Tuesday"></p><p>T-SQL Tuesday is a monthly blog party for the SQL Server community (or Microsoft Data Platform community. Although it’s called T-SQL Tuesday, it’s not limited to SQL Server database engine only). It is the brainchild of Adam Machanic (<a href=http://sqlblog.com/blogs/adam_machanic/>blog</a> | <a href=https://twitter.com/AdamMachanic>twitter</a>).</p><p>This month&rsquo;s T-SQL Tuesday is being hosted by Rob Sewell (<a href="https://sqldbawithabeard.com/2017/09/05/tsql2sday-94-lets-get-all-posh/?utm_content=buffere68cc&amp;utm_medium=social&amp;utm_source=twitter.com&amp;utm_campaign=buffer">blog</a> | <a href=https://twitter.com/sqldbawithbeard>twitter</a>). From his blog post:</p><p><em>This month’s topic: Let’s get all Posh – What are you going to automate today?</em></p><p><em>It is no surprise to those that know me that I will choose PowerShell as the topic for this month. I am passionate about PowerShell because it has enabled me to have the career I have today and to visit numerous countries all around the world, meet people and talk about PowerShell. By my reckoning searching the TSQL Tuesday website it has been over 3 years since we had a topic specific to PowerShell. So I would like you to blog about PowerShell and SQL Server (or other interesting data platform products)</em></p><h1 id=love-me-some-powershell>Love me some PowerShell!</h1><p>Just like Rob, I am also passionate about PowerShell. I love it! I have been using it since PowerShell 2.0 came out and it&rsquo;s been my goto tool for automation and scripting ever since. But before I get to some of the things I&rsquo;ve done with PowerShell let me tell you how I got here.</p><h2 id=my-dark-past-on-the-unix-platform>My dark past on the Unix platform</h2><p>I&rsquo;ve been a DBA for about 20 years. The first 10 of those years were spent working with Informix and Oracle databases on the Unix platform (specifically AIX, Solaris and Linux). The cool thing about being a DBA is that we perform a lot of the same tasks regardless of the platform we are working on. For example:</p><ul><li>System builds</li><li>Backup and recovery</li><li>Updating statistics and index maintenance</li><li>Refreshing development systems</li><li>Database migrations</li></ul><p>The list goes on and on. The major difference I found working on Unix was the tooling. A lot of the graphical tools that we are used to having with SQL Server didn&rsquo;t exist or weren&rsquo;t as mature on Unix. Because of this I became best friends with the Unix shell, mainly ksh and bash. I was very fortunate to be a part of a very strong team who helped me learn a ton about scripting. Anything we had to do with Informix and Oracle was done using shell scripts, and we automated everything. So needless to say I got pretty good at scripting.</p><h2 id=fast-forward-10-yearssql-server-here-i-come>Fast forward 10 years&mldr;SQL Server here I come!</h2><p>About 10 years into my career as a DBA I had a great opportunity present itself. The biggest change for me was that it was more focused on SQL Server, a new platform for me. I decided to take that opportunity and SQL Server has been my primary platform ever since.</p><p>Of course one of the first things I looked for when I entered Windows Land was something similar to what I had been doing on Unix. Luckily for me PowerShell was starting to gain steam and it was a pretty natural fit for me. There are plenty of differences between PowerShell and bash, but the feel of the language made me feel right at home. I was up and running with PowerShell in no time.</p><h2 id=do-you-wanna-get-posh>Do You Wanna Get Posh?!?!</h2><p><img src=/img/2017/08/do_you_wanna_get_rocked.jpg alt="Do You Wanna Get PoSh!"></p><p>So what can you do with PowerShell? I think the best way for me to answer is by telling you what I have done with PowerShell.</p><p>Much of my early PowerShell scripting was simply gathering information about my SQL Servers. My bread and butter has to be the SQL Management Object libraries (a.k.a. SMO). SMO is a set of .NET libraries for interacting with SQL Server. Anything you can do using SQL Servers graphical tools (SSMS, SQL Configuration Manger) you can do using SMO and PowerShell. This has been a foundation of pretty much everything I&rsquo;ve done with PowerShell as a SQL DBA. As time went on the tools I have built became more complex.</p><p>A few things that I have done:</p><ul><li>SQL Agent Job monitoring and daily report</li><li>Weekly schema dumps using the SMO scripter object</li><li>Weekly schema comparisons using RedGate&rsquo;s SQL Compare command line</li><li>Dumping SQL logins and group permissions as well as group membership from active directory</li><li>Automatic SQL Server start & stop scripts</li><li>Multiple database deployment tools for releasing database code (SQL scripts, SQL Server Data Tools)</li><li>A tool to migrate our databases (20,000+) from SQL 2005 to SQL 2012. This tool was built around database mirroring and was fully automated.</li><li>A tool to migrate 15,000 databases from on-prem to Microsoft Azure. Once again a fully automated, database driven solution.</li><li>A migration tool for Amazon RDS (currently in progress)</li></ul><p>The list goes on and on and on.</p><p>I know it can be hard to get started and sometimes the hardest part is picking what to you want to do. If that&rsquo;s the case then maybe one of my projects can spark an idea for you. I also contribute to the <a href=https://dbatools.io/>dbatools.io</a> project when I have time, and were always looking for new contributors so swing on by if you&rsquo;re looking for ideas. We&rsquo;d love to have you join us in the powershell channel on the <a href=https://sqlcommunity.slack.com/>SQL Server Community Slack</a> page. Lots of really awesome people and experienced PowerShell programmers frequent there in case you&rsquo;re looking for help.</p><p>Scripting and automation can be very rewarding, and the benefits you reap in the reliability and stability of your environment can be significant. If you&rsquo;ve been standing on the water&rsquo;s edge, the time to dive on in is now! I promise there are no sharks in this water, only a great community willing to help you succeed.</p><div class=blog-tags><a href=https://www.cjsommer.com/tags/sql-server/>SQL Server</a>&nbsp;</div><hr><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><ul class=share><li><a href="//twitter.com/share?url=https%3a%2f%2fwww.cjsommer.com%2fpost%2f2017-09-11-tsql2sday-94-do-you-wanna-get-posh%2f&amp;text=T-SQL%20Tuesday%2094%20-%20Do%20you%20wanna%20get%20PoSh%3f&amp;via=sommerc70" target=_blank title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.cjsommer.com%2fpost%2f2017-09-11-tsql2sday-94-do-you-wanna-get-posh%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fwww.cjsommer.com%2fpost%2f2017-09-11-tsql2sday-94-do-you-wanna-get-posh%2f&amp;title=T-SQL%20Tuesday%2094%20-%20Do%20you%20wanna%20get%20PoSh%3f" target=_blank title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.cjsommer.com%2fpost%2f2017-09-11-tsql2sday-94-do-you-wanna-get-posh%2f&amp;title=T-SQL%20Tuesday%2094%20-%20Do%20you%20wanna%20get%20PoSh%3f" target=_blank title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fwww.cjsommer.com%2fpost%2f2017-09-11-tsql2sday-94-do-you-wanna-get-posh%2f&amp;title=T-SQL%20Tuesday%2094%20-%20Do%20you%20wanna%20get%20PoSh%3f" target=_blank title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fwww.cjsommer.com%2fpost%2f2017-09-11-tsql2sday-94-do-you-wanna-get-posh%2f&amp;description=T-SQL%20Tuesday%2094%20-%20Do%20you%20wanna%20get%20PoSh%3f" target=_blank title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section><h4 class=see-also>See also</h4><ul><li><a href=/post/2020-10-13-qds-gottchas/>QDS Forced Plans - Gotchas and Limitations</a></li><li><a href=/post/2018-03-02-speaking-at-sqlsaturday-723/>SQL Saturday 723, March 24, 2018 in Rochester, NY. Join us and kick your SQL Server knowledge up a notch!</a></li><li><a href=/post/2017-11-14-tsql2sday-96-folks-who-made-a-difference/>T-SQL Tuesday 96 - Folks Who Have Made a Difference</a></li><li><a href=/post/2017-08-28-wilt-configure-tempdb-rds/>What I Learned Today - Configuring tempdb in RDS</a></li><li><a href=/post/2017-08-04-rds-beware-backup-window/>Beware the automated backup window when running native SQL Server backups in RDS</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://www.cjsommer.com/post/2017-08-28-wilt-configure-tempdb-rds/ data-toggle=tooltip data-placement=top title="What I Learned Today - Configuring tempdb in RDS">&larr; Previous Post</a></li><li class=next><a href=https://www.cjsommer.com/post/2017-11-14-tsql2sday-96-folks-who-made-a-difference/ data-toggle=tooltip data-placement=top title="T-SQL Tuesday 96 - Folks Who Have Made a Difference">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=mailto:cjsommer@gmail.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/cjsommer title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/sommerc70 title=Twitter><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/cjsommer title=LinkedIn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href=cjsommer.com>Chris Sommer</a>
&nbsp;&bull;&nbsp;&copy;
2020
&nbsp;&bull;&nbsp;
<a href=https://www.cjsommer.com>cjsommer.com</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.120.4</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script src=https://code.jquery.com/jquery-3.7.0.slim.min.js integrity=sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script><script src=https://www.cjsommer.com/js/main.js></script><script src=https://www.cjsommer.com/js/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script>$(document).ready(function(){$("pre.chroma").css("padding","0")})</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://www.cjsommer.com/js/load-photoswipe.js></script></body></html>